# 前端详细设计文档

## 前端架构设计

### 技术栈
- **React 18.2**: 核心框架
- **Ant Design 5.x**: UI组件库
- **React Router v6**: 路由管理
- **Axios**: HTTP请求库
- **dayjs**: 日期处理
- **js-cookie**: Cookie管理

### 项目结构
```
frontend/
├── public/
│   ├── index.html          # 入口HTML
│   └── favicon.ico         # 网站图标
├── src/
│   ├── components/         # 通用组件
│   │   ├── Layout/        # 布局组件
│   │   ├── Header/        # 顶部导航
│   │   ├── SearchBox/     # 搜索框
│   │   ├── DocumentCard/  # 文档卡片
│   │   ├── TagSelect/     # 标签选择器
│   │   └── PrivateRoute/  # 路由守卫
│   ├── pages/             # 页面组件
│   │   ├── Login/         # 登录页
│   │   ├── Register/      # 注册页
│   │   ├── Home/          # 首页
│   │   ├── DocumentList/  # 文档列表
│   │   ├── Upload/        # 上传页面
│   │   ├── Search/        # 搜索结果
│   │   └── Admin/         # 管理页面
│   ├── services/          # API服务
│   │   ├── auth.js        # 认证服务
│   │   ├── document.js    # 文档服务
│   │   └── api.js         # 基础配置
│   ├── utils/             # 工具函数
│   │   ├── auth.js        # 认证工具
│   │   ├── storage.js     # 存储管理
│   │   └── format.js      # 格式化工具
│   ├── styles/            # 样式文件
│   │   ├── global.css     # 全局样式
│   │   └── variables.css  # 样式变量
│   ├── App.js             # 根组件
│   ├── App.css            # 根样式
│   └── index.js           # 入口文件
└── package.json           # 项目配置
```

## 核心组件设计

### 1. Layout组件
**功能**：提供统一的页面布局框架
```jsx
// 组件结构
<Layout>
  <Header />        // 顶部导航
  <Content>        // 内容区域
    {children}
  </Content>
  <Footer />       // 页脚信息
</Layout>
```

**Props**:
- `showHeader`: 是否显示头部
- `showFooter`: 是否显示页脚
- `children`: 子组件

### 2. Header组件
**功能**：顶部导航栏，包含Logo、搜索框、用户菜单
```jsx
// 组件结构
<Header>
  <Logo />           // 系统Logo
  <SearchBox />      // 搜索框
  <Navigation />     // 导航菜单
  <UserMenu />       // 用户菜单
</Header>
```

### 3. DocumentCard组件
**功能**：文档信息卡片展示
```jsx
// Props
{
  id: number,
  title: string,
  description: string,
  tags: string[],
  uploadUser: string,
  createdAt: string,
  fileSize: number,
  isPublic: boolean,
  onDownload: Function,
  onDelete: Function
}
```

### 4. SearchBox组件
**功能**：搜索输入框，支持关键词和标签搜索
```jsx
// 组件状态
{
  keyword: string,      // 搜索关键词
  selectedTags: [],     // 选中的标签
  suggestions: []       // 搜索建议
}
```

### 5. PrivateRoute组件
**功能**：路由守卫，控制页面访问权限
```jsx
// 使用示例
<PrivateRoute>
  <DocumentList />
</PrivateRoute>
```

## 页面设计详情

### 1. 登录页面（Login）
**路由**：`/login`
**功能**：
- 邮箱密码登录
- 记住登录状态
- 跳转注册页

**表单字段**：
- email: 邮箱地址
- password: 密码
- remember: 记住我

### 2. 注册页面（Register）
**路由**：`/register`
**功能**：
- 用户注册
- 表单验证
- 自动登录

**表单字段**：
- username: 用户名
- email: 邮箱
- password: 密码
- confirmPassword: 确认密码

### 3. 文档列表页（DocumentList）
**路由**：`/documents`
**功能**：
- 网格/列表视图切换
- 分页加载
- 快速操作（下载、删除）
- 标签筛选

**状态管理**：
```javascript
{
  documents: [],        // 文档列表
  loading: false,       // 加载状态
  pagination: {         // 分页信息
    current: 1,
    pageSize: 10,
    total: 0
  },
  viewMode: 'card',     // 视图模式
  filters: {            // 筛选条件
    tags: [],
    isPublic: null
  }
}
```

### 4. 文档上传页（Upload）
**路由**：`/upload`
**功能**：
- 文件选择和预览
- 文档信息填写
- 标签设置
- 权限设置

**表单设计**：
```javascript
{
  file: File,           // 文件对象
  title: string,        // 文档标题
  description: string,  // 文档描述
  tags: string,        // 标签（逗号分隔）
  isPublic: boolean    // 是否公开
}
```

### 5. 搜索结果页（Search）
**路由**：`/search`
**功能**：
- 显示搜索结果
- 搜索条件展示
- 结果排序
- 分页加载

### 6. 管理页面（Admin）
**路由**：`/admin`
**功能**：
- 用户列表管理
- 文档统计信息
- 系统设置

## 路由设计

```javascript
const routes = [
  {
    path: '/',
    element: <Home />,
    public: false
  },
  {
    path: '/login',
    element: <Login />,
    public: true
  },
  {
    path: '/register',
    element: <Register />,
    public: true
  },
  {
    path: '/documents',
    element: <DocumentList />,
    public: false
  },
  {
    path: '/upload',
    element: <Upload />,
    public: false
  },
  {
    path: '/search',
    element: <Search />,
    public: false
  },
  {
    path: '/admin',
    element: <Admin />,
    public: false,
    requireAdmin: true
  }
]
```

## 状态管理

### 全局状态
使用React Context管理全局状态：
```javascript
// AuthContext
{
  user: {
    id: number,
    username: string,
    email: string,
    role: string
  },
  token: string,
  isAuthenticated: boolean,
  login: Function,
  logout: Function
}
```

### 本地存储
- **localStorage**: 存储Token、用户信息
- **sessionStorage**: 存储临时数据
- **Cookie**: 存储记住登录状态

## API服务层设计

### 基础配置
```javascript
// api.js
const API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:3001/api';

// 请求拦截器
axios.interceptors.request.use((config) => {
  const token = localStorage.getItem('token');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});

// 响应拦截器
axios.interceptors.response.use(
  (response) => response.data,
  (error) => {
    if (error.response?.status === 401) {
      // 跳转登录页
    }
    return Promise.reject(error);
  }
);
```

### 服务模块
```javascript
// auth.js
export const authService = {
  login: (email, password) => axios.post('/auth/login', { email, password }),
  register: (data) => axios.post('/auth/register', data),
  logout: () => localStorage.removeItem('token')
};

// document.js
export const documentService = {
  list: (params) => axios.get('/documents', { params }),
  upload: (formData) => axios.post('/documents', formData),
  download: (id) => axios.get(`/documents/${id}/download`),
  delete: (id) => axios.delete(`/documents/${id}`),
  search: (params) => axios.get('/search', { params })
};
```

## UI/UX设计规范

### 设计原则
1. **简洁清晰**：界面简洁，操作直观
2. **响应式设计**：适配不同屏幕尺寸
3. **一致性**：统一的交互模式和视觉风格
4. **反馈及时**：操作反馈明确

### 颜色方案
```css
:root {
  --primary-color: #1890ff;    /* 主色调 */
  --success-color: #52c41a;    /* 成功色 */
  --warning-color: #faad14;    /* 警告色 */
  --error-color: #f5222d;      /* 错误色 */
  --text-color: #262626;       /* 文本色 */
  --border-color: #d9d9d9;     /* 边框色 */
  --bg-color: #fafafa;         /* 背景色 */
}
```

### 响应式断点
```css
/* 移动设备 */
@media (max-width: 576px) { }

/* 平板设备 */
@media (max-width: 768px) { }

/* 桌面设备 */
@media (min-width: 769px) { }
```

## 性能优化

### 1. 代码分割
```javascript
// 路由懒加载
const DocumentList = lazy(() => import('./pages/DocumentList'));
const Admin = lazy(() => import('./pages/Admin'));
```

### 2. 图片优化
- 使用适当的图片格式
- 实现图片懒加载
- 压缩图片大小

### 3. 缓存策略
- API响应缓存
- 静态资源缓存
- Service Worker离线缓存

### 4. 性能监控
- 使用React DevTools分析组件性能
- 监控首屏加载时间
- 跟踪用户交互响应时间

## 错误处理

### 全局错误边界
```javascript
class ErrorBoundary extends React.Component {
  componentDidCatch(error, errorInfo) {
    // 记录错误日志
    console.error('Error caught:', error, errorInfo);
  }

  render() {
    if (this.state.hasError) {
      return <ErrorPage />;
    }
    return this.props.children;
  }
}
```

### 网络错误处理
- 请求超时处理
- 网络断开提示
- 重试机制

### 表单验证
- 前端实时验证
- 提交前完整验证
- 友好的错误提示

---
**更新时间**：2025-09-20
**文档版本**：v1.0